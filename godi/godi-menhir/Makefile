# This file was automatically generated by godiva version 0.9.7
.include "../../mk/bsd.prefs.mk"

VERSION=        20140422
PKGNAME=        godi-menhir-${VERSION}
PKGREVISION=    1
DISTNAME=       menhir-${VERSION}
DISTFILES=      menhir-${VERSION}.tar.gz
CATEGORIES=     godi
MASTER_SITES=   http://gallium.inria.fr/~fpottier/menhir/
HOMEPAGE=       http://gallium.inria.fr/~fpottier/menhir/
COMMENT=        A LR(1) parser generator for Objective Caml.

# confopt defaults:


#AUTOGENERATE_PLIST = yes
PKG  =          godi-menhir
.if defined(W32PORT) && ${W32PORT} == "mingw" 
MAKE_FLAGS=     PREFIX=${LOCALBASE_NATIVE} LIBDIR=${LOCALBASE_NATIVE}/lib BINDIR=${LOCALBASE_NATIVE}/bin MANDIR=${LOCALBASE_NATIVE}/man 
.else
MAKE_FLAGS=     PREFIX=${PREFIX} LIBDIR=${PREFIX}/lib BINDIR=${PREFIX}/bin MANDIR=${PREFIX}/man 
.endif
DEPENDS+= godi-ocaml>=3.09:../../godi/godi-ocaml


# HAS_CONFIGURE = yes
MAKE_ENV+=  ${BUILD_OCAMLFIND_ENV} PKGBASE=${PKGBASE:Q}


pre-configure-copy:
.	if exists(files)
	    cd files && ${PAX} -rw -pp . ${WRKSRC}
.	endif

pre-configure: pre-configure-copy

ALL_TARGET=     all
.if ${GODI_HAVE_OCAMLOPT} == "yes"
# ALL_TARGET+= opt
.endif

post-install:
	mkdir -p ${PREFIX}/doc/${PKG}
.	for DOC in manual.pdf menhir.1
	    if [ -d ${WRKSRC}/${DOC} ]; then cd ${WRKSRC} && ${PAX} -rw -pp ${DOC} ${PREFIX}/doc/${PKG}; else install -m 0644 ${WRKSRC}/${DOC} ${PREFIX}/doc/${PKG}; fi
.	endfor
	@for f in ${PREFIX}/bin/menhi* ; do \
	  if [ ! -f "$$f" ] || [ -f "$${f}.exe" ]; then \
	     continue ; \
	  fi ; \
	  case "$$f" in \
	    *exe) continue ;; \
	    *) mv "$$f" "$${f}.exe" ;; \
	  esac \
	done

.include "../../mk/bsd.pkg.mk"
