diff -b -B -u -r ../work-ref/tcl8.6.2/generic/tclInt.h tcl8.6.2/generic/tclInt.h
--- ../work-ref/tcl8.6.2/generic/tclInt.h	2014-08-26 01:02:37.000000000 +0200
+++ tcl8.6.2/generic/tclInt.h	2014-09-27 13:17:45.433876158 +0200
@@ -3204,7 +3204,7 @@
 MODULE_SCOPE int	TclClockOldscanObjCmd(
 			    ClientData clientData, Tcl_Interp *interp,
 			    int objc, Tcl_Obj *const objv[]);
-MODULE_SCOPE int	Tcl_CloseObjCmd(ClientData clientData,
+extern int	Tcl_CloseObjCmd(ClientData clientData,
 			    Tcl_Interp *interp, int objc,
 			    Tcl_Obj *const objv[]);
 MODULE_SCOPE int	Tcl_ConcatObjCmd(ClientData clientData,
@@ -3387,7 +3387,7 @@
 MODULE_SCOPE int	Tcl_RepresentationCmd(ClientData clientData,
 			    Tcl_Interp *interp, int objc,
 			    Tcl_Obj *const objv[]);
-MODULE_SCOPE int	Tcl_ReturnObjCmd(ClientData clientData,
+extern int	Tcl_ReturnObjCmd(ClientData clientData,
 			    Tcl_Interp *interp, int objc,
 			    Tcl_Obj *const objv[]);
 MODULE_SCOPE int	Tcl_ScanObjCmd(ClientData clientData,
diff -b -B -u -r ../work-ref/tcl8.6.2/generic/tclPort.h tcl8.6.2/generic/tclPort.h
--- ../work-ref/tcl8.6.2/generic/tclPort.h	2014-07-28 16:43:55.000000000 +0200
+++ tcl8.6.2/generic/tclPort.h	2014-09-27 13:17:45.433876158 +0200
@@ -20,7 +20,7 @@
 #if defined(_WIN32)
 #   include "tclWinPort.h"
 #else
-#   include "tclUnixPort.h"
+#   include "../unix/tclUnixPort.h"
 #endif
 #include "tcl.h"
 
diff -b -B -u -r ../work-ref/tcl8.6.2/unix/installManPage tcl8.6.2/unix/installManPage
--- ../work-ref/tcl8.6.2/unix/installManPage	2014-08-26 17:23:08.000000000 +0200
+++ tcl8.6.2/unix/installManPage	2014-09-27 13:17:45.417875622 +0200
@@ -103,7 +103,7 @@
     Target=$Target.$Section$Suffix
     rm -f $Dir/$Target $Dir/$Target.*
     if test -z "$First" ; then
-	First=$Target
+	First=$(echo $Target | sed -e 's/:/-/g')
 	sed -e "/man\.macros/r $SrcDir/man.macros" -e "/man\.macros/d" \
 	    $ManPage > $Dir/$First
 	chmod 444 $Dir/$First
diff -b -B -u -r ../work-ref/tcl8.6.2/win/configure.in tcl8.6.2/win/configure.in
--- ../work-ref/tcl8.6.2/win/configure.in	2014-08-26 17:23:09.000000000 +0200
+++ tcl8.6.2/win/configure.in	2014-09-27 13:17:45.433876158 +0200
@@ -105,15 +105,7 @@
 
 SC_CONFIG_CFLAGS
 
-# Cross-compiling
-case ${host_alias} in
-*mingw32*)
-    TCL_EXE="tclsh"
-    ;;
-*)
     TCL_EXE="TCL_LIBRARY=\"\${LIBRARY_DIR}\"; export TCL_LIBRARY; ./\${TCLSH}"
-    ;;
-esac
 
 #------------------------------------------------------------------------
 #	Add stuff for zlib; note that this is mostly done in the makefile now
@@ -126,17 +118,9 @@
 ], [
   tcl_ok=yes
 ])
+zlibflags=`pkg-config --libs zlib`
 AS_IF([test "$tcl_ok" = "yes"], [
-  AC_SUBST(ZLIB_DLL_FILE,[\${ZLIB_DLL_FILE}])
-  AS_IF([test "$do64bit" = "yes"], [
-    AS_IF([test "$GCC" == "yes"],[
-      AC_SUBST(ZLIB_LIBS,[\${ZLIB_DIR}/win64/libz.dll.a])
-    ], [
-      AC_SUBST(ZLIB_LIBS,[\${ZLIB_DIR}/win64/zdll.lib])
-    ])
-  ], [
-    AC_SUBST(ZLIB_LIBS,[\${ZLIB_DIR}/win32/zdll.lib])
-  ])
+    AC_SUBST(ZLIB_LIBS,[$zlibflags])
 ], [
   AC_SUBST(ZLIB_OBJS,[\${ZLIB_OBJS}])
 ])
@@ -301,7 +285,13 @@
 eval "TCL_BUILD_STUB_LIB_PATH=\"`pwd`/${TCL_STUB_LIB_FILE}\""
 eval "TCL_STUB_LIB_PATH=\"${libdir}/${TCL_STUB_LIB_FILE}\""
 
-eval "TCL_LIB_FILE=\"${LIBPREFIX}tcl${VER}${LIBSUFFIX}\""
+if test ${SHARED_BUILD} = 0 ; then
+ eval "TCL_LIB_FILE=\"${LIBPREFIX}tcl${VER}${LIBSUFFIX}\""
+else
+ eval "TCL_LIB_FILE=\"${LIBPREFIX}tcl${VER}${DLLSUFFIX}${LIBSUFFIX}\""
+fi
+
+
 eval "TCL_BUILD_LIB_SPEC=\"-L`pwd` -ltcl${VER}${FLAGSUFFIX}\""
 eval "TCL_LIB_SPEC=\"-L${libdir} -ltcl${VER}${FLAGSUFFIX}\""
 
diff -b -B -u -r ../work-ref/tcl8.6.2/win/Makefile.in tcl8.6.2/win/Makefile.in
--- ../work-ref/tcl8.6.2/win/Makefile.in	2014-08-26 17:23:09.000000000 +0200
+++ tcl8.6.2/win/Makefile.in	2014-09-27 13:17:45.425875890 +0200
@@ -102,6 +102,8 @@
 COMPAT_DIR		= $(TOP_DIR)/compat
 PKGS_DIR		= $(TOP_DIR)/pkgs
 ZLIB_DIR		= $(COMPAT_DIR)/zlib
+BUILD_DIR		= @builddir@
+UNIX_DIR		= $(TOP_DIR)/unix
 
 # Converts a POSIX path to a Windows native path.
 CYGPATH			= @CYGPATH@
@@ -134,14 +136,13 @@
 TCL_DLL_FILE		= @TCL_DLL_FILE@
 TCL_LIB_FILE		= @TCL_LIB_FILE@
 DDE_DLL_FILE		= tcldde$(DDEVER)${DLLSUFFIX}
-DDE_LIB_FILE		= @LIBPREFIX@tcldde$(DDEVER)${LIBSUFFIX}
+DDE_LIB_FILE		= @LIBPREFIX@tcldde$(DDEVER)${DLLSUFFIX}${LIBSUFFIX}
 REG_DLL_FILE		= tclreg$(REGVER)${DLLSUFFIX}
-REG_LIB_FILE		= @LIBPREFIX@tclreg$(REGVER)${LIBSUFFIX}
+REG_LIB_FILE		= @LIBPREFIX@tclreg$(REGVER)${DLLSUFFIX}${LIBSUFFIX}
 TEST_DLL_FILE		= tcltest$(VER)${DLLSUFFIX}
-TEST_LIB_FILE		= @LIBPREFIX@tcltest$(VER)${LIBSUFFIX}
-ZLIB_DLL_FILE		= zlib1.dll
+TEST_LIB_FILE		= @LIBPREFIX@tcltest$(VER)${DLLSUFFIX}${LIBSUFFIX}
 
-SHARED_LIBRARIES 	= $(TCL_DLL_FILE) @ZLIB_DLL_FILE@
+SHARED_LIBRARIES 	= $(TCL_DLL_FILE)
 STATIC_LIBRARIES	= $(TCL_LIB_FILE)
 
 TCLSH			= tclsh$(VER)${EXESUFFIX}
@@ -189,6 +190,12 @@
 RM		= rm -f
 COPY		= cp
 
+INSTALL			= $(SHELL) $(UNIX_DIR)/install-sh -c
+INSTALL_PROGRAM		= ${INSTALL}
+INSTALL_LIBRARY		= ${INSTALL}
+INSTALL_DATA		= ${INSTALL} -m 644
+INSTALL_DATA_DIR	= ${INSTALL} -d -m 755
+
 CC_SWITCHES = ${CFLAGS} ${CFLAGS_WARNING} ${TCL_SHLIB_CFLAGS} -I"${ZLIB_DIR}" \
 -I"${GENERIC_DIR_NATIVE}" -DTCL_TOMMATH -DMP_PREC=4 -I"${TOMMATH_DIR_NATIVE}" \
 -I"${WIN_DIR_NATIVE}" ${AC_FLAGS} \
@@ -436,7 +443,7 @@
 	@MAKE_STUB_LIB@ ${STUB_OBJS}
 	@POST_MAKE_LIB@
 
-${TCL_DLL_FILE}: ${TCL_OBJS} tcl.$(RES) @ZLIB_DLL_FILE@
+${TCL_DLL_FILE}: ${TCL_OBJS} tcl.$(RES)
 	@$(RM) ${TCL_DLL_FILE} $(TCL_LIB_FILE)
 	@MAKE_DLL@ ${TCL_OBJS} tcl.$(RES) $(SHLIB_LD_LIBS)
 	@VC_MANIFEST_EMBED_DLL@
@@ -456,14 +463,6 @@
 	@$(RM) ${TEST_DLL_FILE} ${TEST_LIB_FILE}
 	@MAKE_DLL@ ${TCLTEST_OBJS} $(TCL_STUB_LIB_FILE) $(SHLIB_LD_LIBS)
 
-# use pre-built zlib1.dll
-${ZLIB_DLL_FILE}: ${TCL_STUB_LIB_FILE}
-	@if test "@ZLIB_LIBS@set" != "${ZLIB_DIR}/win32/zdll.libset" ; then \
-		$(COPY) $(ZLIB_DIR)/win64/${ZLIB_DLL_FILE} ${ZLIB_DLL_FILE}; \
-	else \
-		$(COPY) $(ZLIB_DIR)/win32/${ZLIB_DLL_FILE} ${ZLIB_DLL_FILE}; \
-	fi;
-
 # Add the object extension to the implicit rules. By default .obj is not
 # automatically added.
 
@@ -556,8 +555,7 @@
 	    do \
 	    if [ ! -d $$i ] ; then \
 		echo "Making directory $$i"; \
-		$(MKDIR) $$i; \
-		chmod 755 $$i; \
+		$(INSTALL_DATA_DIR) $$i; \
 		else true; \
 		fi; \
 	    done;
@@ -565,43 +563,43 @@
 	    do \
 	    if [ ! -d $(LIB_INSTALL_DIR)/$$i ] ; then \
 		echo "Making directory $(LIB_INSTALL_DIR)/$$i"; \
-		$(MKDIR) $(LIB_INSTALL_DIR)/$$i; \
+		$(INSTALL_DATA_DIR) $(LIB_INSTALL_DIR)/$$i; \
 		else true; \
 		fi; \
 	    done;
-	@for i in $(TCL_DLL_FILE) $(ZLIB_DLL_FILE) $(TCLSH); \
+	@for i in $(TCL_DLL_FILE) $(TCLSH); \
 	    do \
 	    if [ -f $$i ]; then \
 		echo "Installing $$i to $(BIN_INSTALL_DIR)/"; \
-		$(COPY) $$i "$(BIN_INSTALL_DIR)"; \
+		$(INSTALL_PROGRAM) $$i "$(BIN_INSTALL_DIR)"; \
 	    fi; \
 	    done
 	@for i in tclConfig.sh tclooConfig.sh $(TCL_LIB_FILE) $(TCL_STUB_LIB_FILE); \
 	    do \
 	    if [ -f $$i ]; then \
 		echo "Installing $$i to $(LIB_INSTALL_DIR)/"; \
-		$(COPY) $$i "$(LIB_INSTALL_DIR)"; \
+		$(INSTALL_DATA) $$i "$(LIB_INSTALL_DIR)"; \
 	    fi; \
 	    done
 	@if [ -f $(DDE_DLL_FILE) ]; then \
 	    echo Installing $(DDE_DLL_FILE); \
-	    $(COPY) $(DDE_DLL_FILE) $(LIB_INSTALL_DIR)/dde${DDEDOTVER}; \
-	    $(COPY) $(ROOT_DIR)/library/dde/pkgIndex.tcl \
+	    $(INSTALL_LIBRARY) $(DDE_DLL_FILE) $(LIB_INSTALL_DIR)/dde${DDEDOTVER}; \
+	    $(INSTALL_LIBRARY) $(ROOT_DIR)/library/dde/pkgIndex.tcl \
 		$(LIB_INSTALL_DIR)/dde${DDEDOTVER}; \
 	    fi
 	@if [ -f $(DDE_LIB_FILE) ]; then \
 	    echo Installing $(DDE_LIB_FILE); \
-	    $(COPY) $(DDE_LIB_FILE) $(LIB_INSTALL_DIR)/dde${DDEDOTVER}; \
+	    $(INSTALL_DATA) $(DDE_LIB_FILE) $(LIB_INSTALL_DIR)/dde${DDEDOTVER}; \
 	    fi
 	@if [ -f $(REG_DLL_FILE) ]; then \
 	    echo Installing $(REG_DLL_FILE); \
-	    $(COPY) $(REG_DLL_FILE) $(LIB_INSTALL_DIR)/reg${REGDOTVER}; \
-	    $(COPY) $(ROOT_DIR)/library/reg/pkgIndex.tcl \
+	    $(INSTALL_LIBRARY) $(REG_DLL_FILE) $(LIB_INSTALL_DIR)/reg${REGDOTVER}; \
+	    $(INSTALL_LIBRARY) $(ROOT_DIR)/library/reg/pkgIndex.tcl \
 		$(LIB_INSTALL_DIR)/reg${REGDOTVER}; \
 	    fi
 	@if [ -f $(REG_LIB_FILE) ]; then \
 	    echo Installing $(REG_LIB_FILE); \
-	    $(COPY) $(REG_LIB_FILE) $(LIB_INSTALL_DIR)/reg${REGDOTVER}; \
+	    $(INSTALL_DATA) $(REG_LIB_FILE) $(LIB_INSTALL_DIR)/reg${REGDOTVER}; \
 	    fi
 
 install-libraries: libraries install-tzdata install-msgs
@@ -610,7 +608,7 @@
 	    do \
 	    if [ ! -d $$i ] ; then \
 		echo "Making directory $$i"; \
-		$(MKDIR) $$i; \
+		$(INSTALL_DATA_DIR) $$i; \
 		else true; \
 		fi; \
 	    done;
@@ -618,7 +616,7 @@
 	    do \
 	    if [ ! -d $(SCRIPT_INSTALL_DIR)/$$i ] ; then \
 		echo "Making directory $(SCRIPT_INSTALL_DIR)/$$i"; \
-		$(MKDIR) $(SCRIPT_INSTALL_DIR)/$$i; \
+		$(INSTALL_DATA_DIR) $(SCRIPT_INSTALL_DIR)/$$i; \
 		else true; \
 		fi; \
 	    done;
@@ -672,6 +670,28 @@
 	    "$(ROOT_DIR)/library/msgs" "$(SCRIPT_INSTALL_DIR)/msgs"
 
 install-doc: doc
+	@for i in "$(MAN_INSTALL_DIR)" "$(MAN1_INSTALL_DIR)" "$(MAN3_INSTALL_DIR)" "$(MANN_INSTALL_DIR)" ; \
+	    do \
+	    if [ ! -d "$$i" ] ; then \
+		echo "Making directory $$i"; \
+		$(INSTALL_DATA_DIR) "$$i"; \
+		else true; \
+		fi; \
+	    done;
+	@echo "Installing and cross-linking top-level (.1) docs to $(MAN1_INSTALL_DIR)/";
+	@for i in $(TOP_DIR)/doc/*.1; do \
+	    $(SHELL) $(UNIX_DIR)/installManPage $(MAN_FLAGS) $$i "$(MAN1_INSTALL_DIR)"; \
+	done
+
+	@echo "Installing and cross-linking C API (.3) docs to $(MAN3_INSTALL_DIR)/";
+	@for i in $(TOP_DIR)/doc/*.3; do \
+	    $(SHELL) $(UNIX_DIR)/installManPage $(MAN_FLAGS) $$i "$(MAN3_INSTALL_DIR)"; \
+	done
+
+	@echo "Installing and cross-linking command (.n) docs to $(MANN_INSTALL_DIR)/";
+	@for i in $(TOP_DIR)/doc/*.n; do \
+	    $(SHELL) $(UNIX_DIR)/installManPage $(MAN_FLAGS) $$i "$(MANN_INSTALL_DIR)"; \
+	done
 
 # Optional target to install private headers
 install-private-headers: libraries
@@ -679,7 +699,7 @@
 	    do \
 	    if [ ! -d $$i ] ; then \
 		echo "Making directory $$i"; \
-		$(MKDIR) $$i; \
+		$(INSTALL_DATA_DIR) $$i; \
 		else true; \
 		fi; \
 	    done;
@@ -689,7 +709,7 @@
 		"$(GENERIC_DIR)/tclOOInt.h" "$(GENERIC_DIR)/tclOOIntDecls.h" \
 		"$(WIN_DIR)/tclWinPort.h" ; \
 	    do \
-	    $(COPY) "$$i" "$(PRIVATE_INCLUDE_INSTALL_DIR)"; \
+	    $(INSTALL_DATA) "$$i" "$(PRIVATE_INCLUDE_INSTALL_DIR)"; \
 	    done;
 
 # Specifying TESTFLAGS on the command line is the standard way to pass args to
diff -b -B -u -r ../work-ref/tcl8.6.2/win/tcl.m4 tcl8.6.2/win/tcl.m4
--- ../work-ref/tcl8.6.2/win/tcl.m4	2014-08-26 17:23:09.000000000 +0200
+++ tcl8.6.2/win/tcl.m4	2014-09-27 13:17:45.425875890 +0200
@@ -715,7 +715,7 @@
 	SHLIB_LD='${CC} -shared'
 	SHLIB_LD_LIBS='${LIBS}'
 	MAKE_DLL="\${SHLIB_LD} \$(LDFLAGS) -o \[$]@ ${extra_ldflags} \
-	    -Wl,--out-implib,\$(patsubst %.dll,lib%.a,\[$]@)"
+	    -Wl,--out-implib,\$(patsubst %.dll,lib%.dll.a,\[$]@)"
 	# DLLSUFFIX is separate because it is the building block for
 	# users of tclConfig.sh that may build shared or static.
 	DLLSUFFIX="\${DBGX}.dll"
diff -b -B -u -r ../work-ref/tcl8.6.2/win/tclWinInt.h tcl8.6.2/win/tclWinInt.h
--- ../work-ref/tcl8.6.2/win/tclWinInt.h	2014-07-28 16:43:56.000000000 +0200
+++ tcl8.6.2/win/tclWinInt.h	2014-09-27 13:17:45.433876158 +0200
@@ -45,7 +45,11 @@
 #endif
 
 #ifdef _WIN64
+# ifdef __USE_MINGW_ANSI_STDIO
+#         define TCL_I_MODIFIER        "z"
+# else
 #         define TCL_I_MODIFIER        "I"
+# endif
 #else
 #         define TCL_I_MODIFIER        ""
 #endif
